layout: '[post]'
title: 使用Git进行团队协作基础教程
date: 2016-10-09 22:10:48
tags:
  - 协作开发
  - 工具
categories: "其他教程"
---
最近，有几个项目需要用到Git进行协作开发，虽然Git天生就对团队协作非常友好，但是基于命令行的GUI使用起来还是有一些门槛，所以在这里写一篇博客简单总结一下。
其实如果只是进行基本的小型团队协作，`Git`的使用门槛非常低，只需要掌握几个基本的操作就可以。
这篇博文就完全够你用了。
<!--more-->
### 1:适用人群
* 规模不超过20人的小团队适用GIt进行协作开发
> 团队规模过大时，会产生很多难以预知和管理的问题，需要更精细化的分工和更全面的守则
>
----
### 2:知识准备
* git的基本使用
* 了解本地仓库、远程仓库的区别
* 基本的命令行操作

----
### 3:开始使用
由于这次我们使用的是码云来进行团队协作，所以以下所有的内容都基于码云。
> 码云是和Github相同类型的远程托管仓库，基本操作和Github可以通用。
>

 #### 3.1:注册码云或者Github账号
打开码云网站，[http://git.oschina.net/](http://git.oschina.net),注册一个新用户，记下你的用户名。`Github`在这里注册，[www.github.com](http://www.github.com)，同样的步骤。
 #### 3.2:本地安装并连接到远程仓库
在本地安装Git，安装步骤我不在赘述，在我的上一篇博文已经写的很详细了。
这里我说一下，怎么使用SSH连接到远程仓库，这样你每次推送更新的使用就不用输入账号密码了。

##### 3.2.1:检查本地ssh文件夹
> 如果你没有安装或者使用过Git类工具，本地应该是没有这个文件的
>

```
$ ls -al ~/.ssh  //列出电脑上的SSH文件夹，如果存在的话
```
发现很多同学不懂这句话什么意思，我简单说一下。`ls`是`list`的缩写，表示列出所有文件，` -al`是`ls`命令的参数表示所有目录并单列列出文件，`~`代表你的`Home`目录，在`windows`上也就是以你用户名命名的那个目录，`ssh`文件夹是个隐藏文件夹，所以前面加`.`。这些基本的`linux`命令大家可以好好看一下。
如果没有列出`ssh`文件那么就继续下一步，如果存在`ssh`文件你可以使用旧的文件或者删除这个目录，继续第二步生成新的`ssh`文件。
##### 3.2.2:生成ssh密钥
```
$ ssh-keygen -t rsa -b 4096 -C "username@example.com"
//生成基于此用户名的SSH Keys,这里的邮箱填写前面注册时的邮箱即可，
```
当然如果你害怕泄露隐私，也可以填写其他邮箱，不影响使用。之后，回车确认即可。
##### 3.2.3:添加ssh key到码云账户
这时候你在C盘的用户名文件夹下应该能看到隐藏文件夹`.ssh`，打开此文件夹下的`id_rsa.pub`[可使用Nodepad++或sublime打开]文件，复制全部内容。
然后，在码云右上方点击小人图标，进入个人资料页，选择下方的"`SSH 公钥`”。接着粘贴`key`，输入`Keys`的名字（可以随便输入，是为了让你有多个`Keys`时能够分辨），点击”确定”按钮。
![码云](/img/mayun-key.jpg)
##### 3.2.4:检查是否能够连接到码云
```
$ ssh -T git@git.oschina.net
```
如果出现：
```
$ Welcome to Git@OSC, yourname!
```
说明连接成功。
##### 3.2.5:clone你的项目到本地
> 如果之前已经在本地开发项目了，也可以初始化一个仓库，并push到远端，步骤类似，这里以全新clone为例。
>

```
$ git clone git@git.oschina.net:username/projectname.git
```
这样就`clone`了一个`username`下的`projectname`的项目，等待完成即可，默认`clone`下来的项目，仓库名是`origin`。
#### 3.3:加入组织并建立分支
> 这部分的操作是由项目的负责人在码云网页端完成的
>

##### 3.3.1:创建组织并添加成员
在用户首页左下角有一个组织选项，点击添加组织。界面如下：
![组织](/img/mayun-zuzhi.jpg)
> 组织是比项目更高一级的单位，项目时几个人合作开发的协作平台，而组织是几个项目的集合，用于管理多个项目。
>

创建之后就可以邀请新成员了，界面如下：
![邀请](/img/mayun-invate.jpg)
##### 3.3.2:创建项目组并添加分支
进入之后，点击添加项目，就可以添加项目了，界面如下：
![邀请](/img/mayun-project.jpg)个成员都建立一个分支，界面如下：
![分支](/img/mayun-branch.jpg)
起点默认即可，分支名称填写成员昵称。
> 
当然，你也可以根据项目的开发情况来建立分支，比如发行版分支、开发板分支、存在BUG的分支、新版本分支等.
> 

----
#### 3.4:开始团队协作
##### 3.4.1:同步远端内容到本地
```
$ git pull origin master
```
这里的`master`是你开发的项目主分支，开发前先将远端内容同步下来，因为别人可能合并了新的内容到主分支，为了保证开发进度的一致，需要先`pull`下主分支内容。
##### 3.4.2:将改动推送到远端分支
```
$ git checkout 你的开发分支名 //切换到你的开发分支
```
现在你可以进行开发，开发完成并确认无误后你可以将改动推送到远程开发分支。
> 这一步时，很多人会碰到没有分支的情况，这里说明一下。如果你`clone`的时候，远端项目的分支还没有建立，你`clone`下来的项目是没有分支结构的，需要你自己新建分支并推送到远端仓库或者·	在远端仓库分支建立后再次`clone`，就会将仓库的分支结构也`clone`下来。
>

```
$ git add * //t添加所有改动文件到暂存区
$ git commit -m "开发说明"  //添加提交说明
$ git push origin 你的开发分支名
```
这里只是将改动推送到属于你自己的开发分支，所以这里的分支名是为你建立的开发分支的名字。
##### 3.4.3:将远端分支合并到主分支
现在你已经在本地进行了一些开发了，并且确认这些开发可以使用，想要推送到主分支，让大家在这个基础上继续开发，所以你需要合并到主分支。
```
$ git branch -a  //查看本地和远程所有分支，带*号是当前所在分支。
$ git checkout master //切换到主分支
$ git merge 你的开发分支名 //将你的开发分支合并到主分支
```
> 合并到主分支后，所有的成员拉取的内容都会改变，所以合并到主分支一定要谨慎。
>

----
### 4:一些建议
* 同样的部分最好由一个人负责，不要多个人改动同一个文件，否则很容易出现冲突
出现冲突怎么处理呢？举个例子：
在我合并到主分支的时候，出现了不能自动修正的冲突。
```
Automatic merge failed; fix conflicts and then commit the result. //一般会这么提示
```
找到冲突的文件，修改冲突后的部分，如果不知道冲突的部分在哪里，可以拉取主分支内容，在本地比对，修改后再提交。
```
$ git add 冲突的文件
```
再次提交远程开发分支，并合并到主分支。
* 远程的开发分支在这个项目中只是作为一个开发内容的备份，就算这个开发分支只存在于本地也可以正常开发和提交，所以在某些项目中这不是必须的。

----
### 5：结语
这些就是最基本的使用Git进行团队协作的基本操作，还有更复杂的冲突处理、版本回退、删除错误提交大家可以下去参考Git的官方教程。我也是第一次使用Git进行团队协作，所以有些地方了解的也不够清楚，有疑问欢迎下方留言一起讨论。
不知不觉已经写了一晚上了，囧。